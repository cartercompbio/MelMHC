#!/bin/bash
#SBATCH --output=/cellar/users/jtalwar/CleanedCode/MelMHC/Preprocessing/out/%A.%x.%a.out
#SBATCH --error=/cellar/users/jtalwar/CleanedCode/MelMHC/Preprocessing/err/%A.%x.%a.err
#SBATCH --array=1-40%50
#SBATCH --mem=25G
#SBATCH -t 9-03:31:13

alleles=(HLA-A01:01,HLA-A01:02,HLA-A01:03 HLA-A02:01,HLA-A02:03,HLA-A02:05 HLA-A02:06,HLA-A02:17,HLA-A03:01 HLA-A03:02,HLA-A11:01,HLA-A11:02 HLA-A11:10,HLA-A23:01,HLA-A24:02 HLA-A26:01,HLA-A26:08,HLA-A29:01 HLA-A29:02,HLA-A30:01,HLA-A30:02 HLA-A30:04,HLA-A31:01,HLA-A32:01 HLA-A33:01,HLA-A33:03,HLA-A34:01 HLA-A34:02,HLA-A66:01,HLA-A68:01 HLA-A68:02,HLA-A74:01,HLA-B07:02 HLA-B07:04,HLA-B07:05,HLA-B08:01 HLA-B13:01,HLA-B13:02,HLA-B14:01 HLA-B14:02,HLA-B15:01,HLA-B15:03 HLA-B15:07,HLA-B15:08,HLA-B15:09 HLA-B15:16,HLA-B15:17,HLA-B15:18 HLA-B15:25,HLA-B18:01,HLA-B27:02 HLA-B27:03,HLA-B27:05,HLA-B35:01 HLA-B35:02,HLA-B35:03,HLA-B35:08 HLA-B37:01,HLA-B38:01,HLA-B38:02 HLA-B39:01,HLA-B39:06,HLA-B39:10 HLA-B40:01,HLA-B40:02,HLA-B41:01 HLA-B41:02,HLA-B42:01,HLA-B44:02 HLA-B44:03,HLA-B44:05,HLA-B45:01 HLA-B46:01,HLA-B47:01,HLA-B48:01 HLA-B49:01,HLA-B50:01,HLA-B51:01 HLA-B51:08,HLA-B52:01,HLA-B53:01 HLA-B54:01,HLA-B55:01,HLA-B55:02 HLA-B56:04,HLA-B57:01,HLA-B58:01 HLA-B67:01,HLA-B81:01,HLA-C01:02 HLA-C02:02,HLA-C02:10,HLA-C03:02 HLA-C03:03,HLA-C03:04,HLA-C04:01 HLA-C04:03,HLA-C04:07,HLA-C05:01 HLA-C06:02,HLA-C07:01,HLA-C07:02 HLA-C07:04,HLA-C07:06,HLA-C07:18 HLA-C08:01,HLA-C08:02,HLA-C08:03 HLA-C12:02,HLA-C12:03,HLA-C14:02 HLA-C15:02,HLA-C15:05,HLA-C16:01 HLA-C16:02,HLA-C16:04,HLA-C17:01 HLA-C18:01)
allele_string=${alleles[$SLURM_ARRAY_TASK_ID - 1]}

start_time=$SECONDS
NETMHCPAN=/cellar/users/andreabc/nrnb/software/netMHCpan-4.1/netMHCpan
INPUT_FILE=/cellar/users/jtalwar/CleanedCode/MelMHC/Preprocessing/Mutations.peptides
OUTPUT_DIR=/cellar/users/jtalwar/CleanedCode/MelMHC/Preprocessing/OtherMHC1Files
date
hostname

$NETMHCPAN -a $allele_string -inptype 1 -f $INPUT_FILE -xls -xlsfile $OUTPUT_DIR/$SLURM_ARRAY_TASK_ID.xlsoutput 

date
elapsed=$(( SECONDS - start_time ))
eval "echo Total Script Run Time/Elapsed time: $(date -ud "@$elapsed" +'$((%s/3600/24)) days %H hr %M min %S sec')"